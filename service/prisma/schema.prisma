// schema.prisma
datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
}

model User {
  id        Int      @id @default(autoincrement())
  firstName String
  lastName  String
  password  String
  email     String   @unique
  role      String
  admin     Admin?
  student   Student?
  tutor     Tutor?
}

model Admin {
  id      Int    @id @default(autoincrement())
  adminId String @unique
  user    User   @relation(fields: [userId], references: [id])
  userId  Int    @unique
}

model Student {
  id         Int          @id @default(autoincrement())
  promotion  String
  user       User         @relation(fields: [userId], references: [id])
  userId     Int          @unique
  Internship Internship[]
}

model Tutor {
  id         Int          @id @default(autoincrement())
  user       User         @relation(fields: [userId], references: [id])
  userId     Int          @unique
  Internship Internship[]
}

model Company {
  id         Int          @id @default(autoincrement())
  name       String       @unique
  Internship Internship[]
}

model Internship {
  id          Int          @id @default(autoincrement())
  title       String
  description String
  startDate   DateTime
  endDate     DateTime
  salary      Int
  companyId   Int
  evaluations Evaluation[]
  tutorId     Int
  tutor       Tutor        @relation(fields: [tutorId], references: [id])
  company     Company      @relation(fields: [companyId], references: [id])
  documents   Document[]
  student     Student?     @relation(fields: [studentId], references: [id])
  studentId   Int?
}

model Document {
  id           String @id @default(uuid()) @map("id")
  fileName     String @default("") @db.VarChar(255)
  filePath     String @default("") @db.VarChar(255)
  fileType     String @default("") @db.VarChar(255)
  fileSize     Int?
  documentType String @default("") @db.VarChar(50)

  CdC          CdC[]
  Report       Report[]
  Internship   Internship? @relation(fields: [internshipId], references: [id])
  internshipId Int?
}

model CdC {
  id         Int      @id @default(autoincrement())
  file       String
  documentId String // Le type doit correspondre Ã  Document
  document   Document @relation(fields: [documentId], references: [id])
}

model Report {
  id         Int      @id @default(autoincrement())
  file       String
  documentId String
  document   Document @relation(fields: [documentId], references: [id])
}

model Evaluation {
  id             Int        @id @default(autoincrement())
  evaluation     String
  submissionDate DateTime
  factor         Int
  internshipId   Int
  Internship     Internship @relation(fields: [internshipId], references: [id])
}
